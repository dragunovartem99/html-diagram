var E=Object.defineProperty;var R=e=>{throw TypeError(e)};var M=(e,t,p)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:p}):e[t]=p;var K=(e,t,p)=>M(e,typeof t!="symbol"?t+"":t,p),N=(e,t,p)=>t.has(e)||R("Cannot "+p);var o=(e,t,p)=>(N(e,t,"read from private field"),p?p.call(e):t.get(e)),i=(e,t,p)=>t.has(e)?R("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,p),l=(e,t,p,n)=>(N(e,t,"write to private field"),n?n.call(e,p):t.set(e,p),p),d=(e,t,p)=>(N(e,t,"access private method"),p);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const P of r)if(P.type==="childList")for(const c of P.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function p(r){const P={};return r.integrity&&(P.integrity=r.integrity),r.referrerPolicy&&(P.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?P.credentials="include":r.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function n(r){if(r.ep)return;r.ep=!0;const P=p(r);fetch(r.href,P)}})();function O(){return Array.from({length:64},(e,t)=>{const p=document.createElement("div");return(t*9&8)!==0&&p.setAttribute("dark",""),p})}function T({fen:e,reversed:t}){return t?[...Q(e)].reverse():[...Q(e)]}function Q(e){return e.split(" ")[0].replace(/\//g,"").replace(/\d/g,t=>" ".repeat(+t)).slice(0,64)}var b,k,h,m,g;class z{constructor(){i(this,m);i(this,b,O());i(this,k,"8/8/8/8/8/8/8/8");i(this,h,!1)}get html(){return o(this,b)}set fen(t){l(this,k,t),d(this,m,g).call(this)}set flipped(t){l(this,h,t),d(this,m,g).call(this)}}b=new WeakMap,k=new WeakMap,h=new WeakMap,m=new WeakSet,g=function(){T({fen:o(this,k),reversed:o(this,h)}).forEach((p,n)=>{p===" "?o(this,b)[n].removeAttribute("is"):o(this,b)[n].setAttribute("is",p)})};const F=new Map([["K",{light:"K",dark:"k"}],["Q",{light:"Q",dark:"q"}],["R",{light:"R",dark:"r"}],["B",{light:"B",dark:"b"}],["N",{light:"N",dark:"n"}],["P",{light:"P",dark:"p"}],["k",{light:"Ц",dark:"ц"}],["q",{light:"Ф",dark:"ф"}],["r",{light:"Л",dark:"л"}],["b",{light:"С",dark:"с"}],["n",{light:"К",dark:"к"}],["p",{light:"П",dark:"п"}],[" ",{light:"+",dark:"="}]]),D=new Map([["K","0"],["Q","1"],["R","2"],["B","3"],["N","4"],["P","5"],["k","6"],["q","7"],["r","8"],["b","9"],["n",":"],["p",";"],[" ","+"]]),H=`
	:host {
		display: grid;
		container-type: inline-size;
		grid-template-columns: repeat(8, 1fr);
		grid-auto-rows: 1fr;
	}
	div {
		line-height: 1;
		user-select: none;
		font-family: var(--diagram-font);
		color: var(--diagram-stroke, black);
		font-size: var(--diagram-webkit-unit, 12.5cqw);
	}
	:host([colored]) div {
		position: relative;
		z-index: 0;
	}
	:host([colored]) div::after {
		content: "";
		position: absolute;
		inset: 0;
		z-index: -1;
		color: var(--diagram-fill, white);
		background-color: var(--diagram-light, white);
		-webkit-text-stroke-width: var(--diagram-outline);
	}
	:host([colored]) [dark]::after {
		background: var(--diagram-dark, lightgray);
	}
`;function W(){let e="";for(const[t,{light:p,dark:n}]of F)t===" "?(e+=`div::before { content: "${p}" }`,e+=`[dark]::before { content: "${n}" }`,e+=`:host([colored]) [dark]::before { content: "${p}" }`):(e+=`[is=${t}]::before { content: "${p}" }`,e+=`[dark][is=${t}]::before { content: "${n}" }`,e+=`:host([colored]) [dark][is=${t}]::before { content: "${p}" }`);for(const[t,p]of D)e+=`:host([colored]) [is=${t}]::after { content: "${p}" }`;return e}function I(){const e=new CSSStyleSheet,t=H.concat(W());return e.replaceSync(t),e}function J(e){return typeof e.webkitConvertPointFromNodeToPage=="function"}function _(e){return e!==null}var a,u,f,s,y,S,v;class w extends HTMLElement{constructor(){super();i(this,s);i(this,a);i(this,u);i(this,f);l(this,a,new z),l(this,u,this.attachShadow({mode:"closed"}))}connectedCallback(){d(this,s,y).call(this),d(this,s,S).call(this),J(window)&&d(this,s,v).call(this)}disconnectedCallback(){var p;(p=o(this,f))==null||p.unobserve(this)}attributeChangedCallback(p,n,r){switch(p){case"fen":o(this,a).fen=r;break;case"flipped":o(this,a).flipped=_(r)}}}a=new WeakMap,u=new WeakMap,f=new WeakMap,s=new WeakSet,y=function(){o(this,a).html.forEach(p=>o(this,u).appendChild(p))},S=function(){o(this,u).adoptedStyleSheets.push(I())},v=function(){l(this,f,new ResizeObserver(p=>{requestAnimationFrame(()=>{const r=p[0].target.getBoundingClientRect().width/8;this.setAttribute("style",`--diagram-webkit-unit: ${r}px;`)})})),o(this,f).observe(this)},K(w,"observedAttributes",["fen","flipped"]);const G=["Adventurer","Berlin","Cases","Kingdom","Leipzig","Merida","Smart"];function j(e,t){e.forEach(p=>{const n=document.createElement("option");n.textContent=p,t.appendChild(n)})}function U(e){const t=new CSSStyleSheet,p=`Diagram${e}`,n=`./fonts/${p}`,r=`${p}.woff2`;t.insertRule(`@font-face { font-family: "Diagram ${e}"; src: url("${n}/${r}"); font-display: block; }`),document.adoptedStyleSheets.push(t)}function V(e){const t=document.querySelector("#app");let p=`--diagram-font: Diagram ${e};`;e==="Assistant"&&(p+=" --diagram-spacing: -0.4cqw"),t.setAttribute("style",p)}function B(e){U(e),V(e)}const X=e=>t=>{const p=t.body.getReader(),n=/\r?\n/,r=new TextDecoder;let P="";const c=()=>p.read().then(({done:A,value:C})=>{if(A)P.length>0&&e(JSON.parse(P));else{const $=r.decode(C,{stream:!0});P+=$;const q=P.split(n);P=q.pop();for(const L of q.filter(x=>x))e(JSON.parse(L));return c()}});return c()};function Y(e){const t=fetch("https://lichess.org/api/tv/feed"),p=r=>e(r),n=()=>console.log("The stream has completed");t.then(X(p)).then(n)}const Z=["rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1","rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq - 0 1","rnbqkbnr/pppp1ppp/8/4p3/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 2","rnbqkbnr/pppp1ppp/8/4p3/4PP2/8/PPPP2PP/RNBQKBNR b KQkq - 0 2","rnbqkbnr/pppp1ppp/8/8/4Pp2/8/PPPP2PP/RNBQKBNR w KQkq - 0 3","rnbqkbnr/pppp1ppp/8/8/4Pp2/5N2/PPPP2PP/RNBQKB1R b KQkq - 1 3","rnbqkb1r/pppp1ppp/5n2/8/4Pp2/5N2/PPPP2PP/RNBQKB1R w KQkq - 2 4","rnbqkb1r/pppp1ppp/5n2/4P3/5p2/5N2/PPPP2PP/RNBQKB1R b KQkq - 0 4","rnbqkb1r/pppp1ppp/8/4P3/5pn1/5N2/PPPP2PP/RNBQKB1R w KQkq - 1 5","rnbqkb1r/pppp1ppp/8/4P3/3P1pn1/5N2/PPP3PP/RNBQKB1R b KQkq - 0 5","rnbqkb1r/pppp1p1p/8/4P1p1/3P1pn1/5N2/PPP3PP/RNBQKB1R w KQkq - 0 6","rnbqkb1r/pppp1p1p/8/4P1p1/3P1pn1/2N2N2/PPP3PP/R1BQKB1R b KQkq - 1 6","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N1nN2/PPP3PP/R1BQKB1R w KQkq - 2 7","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N1nN2/PPP1Q1PP/R1B1KB1R b KQkq - 3 7","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N2N2/PPP1Q1PP/R1B1Kn1R w KQkq - 0 8","rnbqkb1r/pppp1p1p/8/4P1p1/3PNp2/5N2/PPP1Q1PP/R1B1Kn1R b KQkq - 1 8","rnbqkb1r/pppp1p1p/8/4P1p1/3PNp2/4nN2/PPP1Q1PP/R1B1K2R w KQkq - 2 9","rnbqkb1r/pppp1p1p/5N2/4P1p1/3P1p2/4nN2/PPP1Q1PP/R1B1K2R b KQkq - 3 9","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/4nN2/PPP1Q1PP/R1B1K2R w KQ - 4 10","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/4nN2/PPPBQ1PP/R3K2R b KQ - 5 10","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PPnBQ1PP/R3K2R w KQ - 0 11","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PPnBQKPP/R6R b - - 1 11","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PP1BQKPP/n6R w - - 0 12","rnbq1b1r/ppppkp1p/8/3NP1p1/3P1p2/5N2/PP1BQKPP/n6R b - - 1 12","rnbq1b1r/pppp1p1p/4k3/3NP1p1/3P1p2/5N2/PP1BQKPP/n6R w - - 2 13","rnbq1b1r/pppp1p1p/4k3/3NP1p1/2QP1p2/5N2/PP1B1KPP/n6R b - - 3 13","rnbq1b1r/p1pp1p1p/4k3/1p1NP1p1/2QP1p2/5N2/PP1B1KPP/n6R w - - 0 14","rnbq1b1r/p1pp1p1p/4k3/1p1NP1N1/2QP1p2/8/PP1B1KPP/n6R b - - 0 14","rnb2b1r/p1pp1p1p/4k3/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R w - - 0 15","rnb2b1r/p1Np1p1p/4k3/1p2P1q1/2QP1p2/8/PP1B1KPP/n6R b - - 0 15","rnb2b1r/p1Npkp1p/8/1p2P1q1/2QP1p2/8/PP1B1KPP/n6R w - - 1 16","rnb2b1r/p2pkp1p/8/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R b - - 2 16","rnb2b1r/p2p1p1p/4k3/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R w - - 3 17","rnb2b1r/p2p1p1p/4k3/1p2P1q1/2QP1N2/8/PP1B1KPP/n6R b - - 0 17","rnb2b1r/p2pkp1p/8/1p2P1q1/2QP1N2/8/PP1B1KPP/n6R w - - 1 18","rnb2b1r/p2pkp1p/8/1p1NP1q1/2QP4/8/PP1B1KPP/n6R b - - 2 18","rnb1kb1r/p2p1p1p/8/1p1NP1q1/2QP4/8/PP1B1KPP/n6R w - - 3 19","rnQ1kb1r/p2p1p1p/8/1p1NP1q1/3P4/8/PP1B1KPP/n6R b - - 0 19","rnQqkb1r/p2p1p1p/8/1p1NP3/3P4/8/PP1B1KPP/n6R w - - 1 20","rnQqkb1r/p1Np1p1p/8/1p2P3/3P4/8/PP1B1KPP/n6R b - - 2 20","rnQq1b1r/p1Npkp1p/8/1p2P3/3P4/8/PP1B1KPP/n6R w - - 3 21","rnQq1b1r/p1Npkp1p/8/1p2P3/1B1P4/8/PP3KPP/n6R b - - 4 21","rnQq1b1r/p1N1kp1p/3p4/1p2P3/1B1P4/8/PP3KPP/n6R w - - 0 22","rnQq1b1r/p1N1kp1p/3B4/1p2P3/3P4/8/PP3KPP/n6R b - - 0 22","rnQ2b1r/p1N1kp1p/3q4/1p2P3/3P4/8/PP3KPP/n6R w - - 0 23","rn2Qb1r/p1N1kp1p/3q4/1p2P3/3P4/8/PP3KPP/n6R b - - 1 23"];function ee(){const{random:e}=Math,t=e(),p=(n,r)=>n+e()*r;return t<.05?p(0,200):t<.1?p(2e3,1e3):t<.35?p(900,600):p(300,600)}const te=e=>new Promise(t=>setTimeout(t,e));async function pe(e){for(const t of Z)e({d:{fen:t}}),await te(ee())}customElements.define("demo-diagram",w);{const e=document.querySelector("#typography");j(G,e),e.value="Leipzig",B(e.value),e.addEventListener("change",({target:t})=>B(t.value))}{let t=function(p){document.querySelectorAll("demo-diagram").forEach(n=>p?n.setAttribute("colored","colored"):n.removeAttribute("colored"))};var ne=t;const e=document.querySelector("#colored");t(e.checked),e.addEventListener("change",({target:p})=>t(p.checked))}{let e=function({players:t,isFlipped:p,figure:n}){let[r,P]=n.querySelectorAll(".player");p&&([r,P]=[P,r]),P.classList.remove("accent"),r.classList.add("accent"),P.textContent=t[0].user.name,r.textContent=t[1].user.name};var Pe=e;Y(({t,d:p})=>{const n=document.querySelector("figure#live"),r=n.querySelector("demo-diagram");if(r.setAttribute("fen",p.fen),t==="featured"){const P=p.orientation==="black";P?r.setAttribute("flipped","flipped"):r.removeAttribute("flipped"),e({...p,isFlipped:P,figure:n})}})}pe(({d:e})=>{document.querySelector("figure#bronstein").querySelector("demo-diagram").setAttribute("fen",e.fen)});
