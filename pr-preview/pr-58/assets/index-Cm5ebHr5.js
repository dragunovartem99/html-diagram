(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const P of r)if(P.type==="childList")for(const i of P.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function p(r){const P={};return r.integrity&&(P.integrity=r.integrity),r.referrerPolicy&&(P.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?P.credentials="include":r.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function n(r){if(r.ep)return;r.ep=!0;const P=p(r);fetch(r.href,P)}})();function k(){return Array.from({length:64},(t,e)=>{const p=document.createElement("div");return(e*9&8)!==0&&p.setAttribute("dark",""),p})}function h({fen:t,reversed:e}){return e?[...a(t)].reverse():[...a(t)]}function a(t){return t.split(" ")[0].replace(/\//g,"").replace(/\d/g,e=>" ".repeat(+e)).slice(0,64)}class m{#e=k();#t="8/8/8/8/8/8/8/8";#p=!1;#r(){h({fen:this.#t,reversed:this.#p}).forEach((p,n)=>{p===" "?this.#e[n].removeAttribute("is"):this.#e[n].setAttribute("is",p)})}get html(){return this.#e}set fen(e){this.#t=e,this.#r()}set flipped(e){this.#p=e,this.#r()}}const N=new Map([["K",{light:"K",dark:"k"}],["Q",{light:"Q",dark:"q"}],["R",{light:"R",dark:"r"}],["B",{light:"B",dark:"b"}],["N",{light:"N",dark:"n"}],["P",{light:"P",dark:"p"}],["k",{light:"Ц",dark:"ц"}],["q",{light:"Ф",dark:"ф"}],["r",{light:"Л",dark:"л"}],["b",{light:"С",dark:"с"}],["n",{light:"К",dark:"к"}],["p",{light:"П",dark:"п"}],[" ",{light:"+",dark:"="}]]),g=new Map([["K","0"],["Q","1"],["R","2"],["B","3"],["N","4"],["P","5"],["k","6"],["q","7"],["r","8"],["b","9"],["n",":"],["p",";"],[" ","+"]]),q=`
	:host {
		display: grid;
		container-type: inline-size;
		grid-template-columns: repeat(8, 1fr);
		grid-auto-rows: 1fr;
	}
	div {
		line-height: 1;
		user-select: none;
		font-family: var(--diagram-font);
		color: var(--diagram-stroke, black);
		font-size: var(--diagram-webkit-unit, 12.5cqw);
	}
	:host([colored]) div {
		position: relative;
		z-index: 0;
	}
	:host([colored]) div::after {
		content: "";
		position: absolute;
		inset: 0;
		z-index: -1;
		color: var(--diagram-fill, white);
		background-color: var(--diagram-light, white);
		-webkit-text-stroke-width: var(--diagram-outline);
	}
	:host([colored]) [dark]::after {
		background: var(--diagram-dark, lightgray);
	}
`;let o=q;for(const[t,{light:e,dark:p}]of N)t===" "?(o+=`div::before { content: "${e}" }`,o+=`[dark]::before { content: "${p}" }`,o+=`:host([colored]) [dark]::before { content: "${e}" }`):(o+=`[is=${t}]::before { content: "${e}" }`,o+=`[dark][is=${t}]::before { content: "${p}" }`,o+=`:host([colored]) [dark][is=${t}]::before { content: "${e}" }`);for(const[t,e]of g)o+=`:host([colored]) [is=${t}]::after { content: "${e}" }`;function R(){const t=new CSSStyleSheet;return t.replaceSync(o),t}function K(t){return typeof t.webkitConvertPointFromNodeToPage=="function"}function Q(t){return t!==null}class B extends HTMLElement{static observedAttributes=["fen","flipped"];#e=new m;#t;#p;constructor(){super(),this.#t=this.attachShadow({mode:"closed"})}connectedCallback(){this.#r(),this.#n(),K(window)&&this.#P()}disconnectedCallback(){this.#p?.unobserve(this)}#r(){this.#e.html.forEach(e=>this.#t.appendChild(e))}#n(){this.#t.adoptedStyleSheets.push(R())}#P(){const e=()=>{this.setAttribute("style",`--diagram-webkit-unit: ${this.clientWidth/8}px;`)};e(),this.#p=new ResizeObserver(e),this.#p.observe(this)}attributeChangedCallback(e,p,n){e==="fen"?this.#e.fen=n:e==="flipped"&&(this.#e.flipped=Q(n))}}const w=["Adventurer","Berlin","Cases","Kingdom","Leipzig","Merida","Smart"];function y(t,e){t.forEach(p=>{const n=document.createElement("option");n.textContent=p,e.appendChild(n)})}function v(t){const e=new CSSStyleSheet,p=`Diagram${t}`,n=`./fonts/${p}`,r=`${p}.woff2`;e.insertRule(`@font-face { font-family: "Diagram ${t}"; src: url("${n}/${r}"); font-display: block; }`),document.adoptedStyleSheets.push(e)}function S(t){const e=document.querySelector("#app");let p=`--diagram-font: Diagram ${t};`;t==="Assistant"&&(p+=" --diagram-spacing: -0.4cqw"),e.setAttribute("style",p)}function c(t){v(t),S(t)}const A=t=>e=>{const p=e.body.getReader(),n=/\r?\n/,r=new TextDecoder;let P="";const i=()=>p.read().then(({done:l,value:d})=>{if(l)P.length>0&&t(JSON.parse(P));else{const b=r.decode(d,{stream:!0});P+=b;const s=P.split(n);P=s.pop();for(const f of s.filter(u=>u))t(JSON.parse(f));return i()}});return i()};function $(t){const e=fetch("https://lichess.org/api/tv/feed"),p=r=>t(r),n=()=>console.log("The stream has completed");e.then(A(p)).then(n)}const C=["rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1","rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq - 0 1","rnbqkbnr/pppp1ppp/8/4p3/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 2","rnbqkbnr/pppp1ppp/8/4p3/4PP2/8/PPPP2PP/RNBQKBNR b KQkq - 0 2","rnbqkbnr/pppp1ppp/8/8/4Pp2/8/PPPP2PP/RNBQKBNR w KQkq - 0 3","rnbqkbnr/pppp1ppp/8/8/4Pp2/5N2/PPPP2PP/RNBQKB1R b KQkq - 1 3","rnbqkb1r/pppp1ppp/5n2/8/4Pp2/5N2/PPPP2PP/RNBQKB1R w KQkq - 2 4","rnbqkb1r/pppp1ppp/5n2/4P3/5p2/5N2/PPPP2PP/RNBQKB1R b KQkq - 0 4","rnbqkb1r/pppp1ppp/8/4P3/5pn1/5N2/PPPP2PP/RNBQKB1R w KQkq - 1 5","rnbqkb1r/pppp1ppp/8/4P3/3P1pn1/5N2/PPP3PP/RNBQKB1R b KQkq - 0 5","rnbqkb1r/pppp1p1p/8/4P1p1/3P1pn1/5N2/PPP3PP/RNBQKB1R w KQkq - 0 6","rnbqkb1r/pppp1p1p/8/4P1p1/3P1pn1/2N2N2/PPP3PP/R1BQKB1R b KQkq - 1 6","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N1nN2/PPP3PP/R1BQKB1R w KQkq - 2 7","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N1nN2/PPP1Q1PP/R1B1KB1R b KQkq - 3 7","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N2N2/PPP1Q1PP/R1B1Kn1R w KQkq - 0 8","rnbqkb1r/pppp1p1p/8/4P1p1/3PNp2/5N2/PPP1Q1PP/R1B1Kn1R b KQkq - 1 8","rnbqkb1r/pppp1p1p/8/4P1p1/3PNp2/4nN2/PPP1Q1PP/R1B1K2R w KQkq - 2 9","rnbqkb1r/pppp1p1p/5N2/4P1p1/3P1p2/4nN2/PPP1Q1PP/R1B1K2R b KQkq - 3 9","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/4nN2/PPP1Q1PP/R1B1K2R w KQ - 4 10","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/4nN2/PPPBQ1PP/R3K2R b KQ - 5 10","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PPnBQ1PP/R3K2R w KQ - 0 11","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PPnBQKPP/R6R b - - 1 11","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PP1BQKPP/n6R w - - 0 12","rnbq1b1r/ppppkp1p/8/3NP1p1/3P1p2/5N2/PP1BQKPP/n6R b - - 1 12","rnbq1b1r/pppp1p1p/4k3/3NP1p1/3P1p2/5N2/PP1BQKPP/n6R w - - 2 13","rnbq1b1r/pppp1p1p/4k3/3NP1p1/2QP1p2/5N2/PP1B1KPP/n6R b - - 3 13","rnbq1b1r/p1pp1p1p/4k3/1p1NP1p1/2QP1p2/5N2/PP1B1KPP/n6R w - - 0 14","rnbq1b1r/p1pp1p1p/4k3/1p1NP1N1/2QP1p2/8/PP1B1KPP/n6R b - - 0 14","rnb2b1r/p1pp1p1p/4k3/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R w - - 0 15","rnb2b1r/p1Np1p1p/4k3/1p2P1q1/2QP1p2/8/PP1B1KPP/n6R b - - 0 15","rnb2b1r/p1Npkp1p/8/1p2P1q1/2QP1p2/8/PP1B1KPP/n6R w - - 1 16","rnb2b1r/p2pkp1p/8/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R b - - 2 16","rnb2b1r/p2p1p1p/4k3/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R w - - 3 17","rnb2b1r/p2p1p1p/4k3/1p2P1q1/2QP1N2/8/PP1B1KPP/n6R b - - 0 17","rnb2b1r/p2pkp1p/8/1p2P1q1/2QP1N2/8/PP1B1KPP/n6R w - - 1 18","rnb2b1r/p2pkp1p/8/1p1NP1q1/2QP4/8/PP1B1KPP/n6R b - - 2 18","rnb1kb1r/p2p1p1p/8/1p1NP1q1/2QP4/8/PP1B1KPP/n6R w - - 3 19","rnQ1kb1r/p2p1p1p/8/1p1NP1q1/3P4/8/PP1B1KPP/n6R b - - 0 19","rnQqkb1r/p2p1p1p/8/1p1NP3/3P4/8/PP1B1KPP/n6R w - - 1 20","rnQqkb1r/p1Np1p1p/8/1p2P3/3P4/8/PP1B1KPP/n6R b - - 2 20","rnQq1b1r/p1Npkp1p/8/1p2P3/3P4/8/PP1B1KPP/n6R w - - 3 21","rnQq1b1r/p1Npkp1p/8/1p2P3/1B1P4/8/PP3KPP/n6R b - - 4 21","rnQq1b1r/p1N1kp1p/3p4/1p2P3/1B1P4/8/PP3KPP/n6R w - - 0 22","rnQq1b1r/p1N1kp1p/3B4/1p2P3/3P4/8/PP3KPP/n6R b - - 0 22","rnQ2b1r/p1N1kp1p/3q4/1p2P3/3P4/8/PP3KPP/n6R w - - 0 23","rn2Qb1r/p1N1kp1p/3q4/1p2P3/3P4/8/PP3KPP/n6R b - - 1 23"];function L(){const{random:t}=Math,e=t(),p=(n,r)=>n+t()*r;return e<.05?p(0,200):e<.1?p(2e3,1e3):e<.35?p(900,600):p(300,600)}const M=t=>new Promise(e=>setTimeout(e,t));async function x(t){for(const e of C)t({d:{fen:e}}),await M(L())}customElements.define("demo-diagram",B);{const t=document.querySelector("#typography");y(w,t),t.value="Leipzig",c(t.value),t.addEventListener("change",({target:e})=>c(e.value))}{let e=function(p){document.querySelectorAll("demo-diagram").forEach(n=>p?n.setAttribute("colored","colored"):n.removeAttribute("colored"))};var E=e;const t=document.querySelector("#colored");e(t.checked),t.addEventListener("change",({target:p})=>e(p.checked))}{let t=function({players:e,isFlipped:p,figure:n}){let[r,P]=n.querySelectorAll(".player");p&&([r,P]=[P,r]),P.classList.remove("accent"),r.classList.add("accent"),P.textContent=e[0].user.name,r.textContent=e[1].user.name};var O=t;$(({t:e,d:p})=>{const n=document.querySelector("figure#live"),r=n.querySelector("demo-diagram");if(r.setAttribute("fen",p.fen),e==="featured"){const P=p.orientation==="black";P?r.setAttribute("flipped","flipped"):r.removeAttribute("flipped"),t({...p,isFlipped:P,figure:n})}})}x(({d:t})=>{document.querySelector("figure#bronstein").querySelector("demo-diagram").setAttribute("fen",t.fen)});
