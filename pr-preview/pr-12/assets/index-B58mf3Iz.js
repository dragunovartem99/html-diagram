var J=Object.defineProperty;var S=p=>{throw TypeError(p)};var U=(p,e,t)=>e in p?J(p,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[e]=t;var v=(p,e,t)=>U(p,typeof e!="symbol"?e+"":e,t),Q=(p,e,t)=>e.has(p)||S("Cannot "+t);var s=(p,e,t)=>(Q(p,e,"read from private field"),t?t.call(p):e.get(p)),a=(p,e,t)=>e.has(p)?S("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(p):e.set(p,t),b=(p,e,t,n)=>(Q(p,e,"write to private field"),n?n.call(p,t):e.set(p,t),t),i=(p,e,t)=>(Q(p,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const P of r)if(P.type==="childList")for(const l of P.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const P={};return r.integrity&&(P.integrity=r.integrity),r.referrerPolicy&&(P.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?P.credentials="include":r.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function n(r){if(r.ep)return;r.ep=!0;const P=t(r);fetch(r.href,P)}})();function V(){return new Map([["K",{light:"K",dark:"k"}],["Q",{light:"Q",dark:"q"}],["R",{light:"R",dark:"r"}],["B",{light:"B",dark:"b"}],["N",{light:"N",dark:"n"}],["P",{light:"P",dark:"p"}],["k",{light:"Ц",dark:"ц"}],["q",{light:"Ф",dark:"ф"}],["r",{light:"Л",dark:"л"}],["b",{light:"С",dark:"с"}],["n",{light:"К",dark:"к"}],["p",{light:"П",dark:"п"}],[" ",{light:"_",dark:"-"}]])}function j(){return new Map([["K","0"],["Q","1"],["R","2"],["B","3"],["N","4"],["P","5"],["k","6"],["q","7"],["r","8"],["b","9"],["n",":"],["p",";"],[" ","_"]])}var g,q,c,E,M,L,N;class I{constructor(){a(this,c);a(this,g,V());a(this,q,j())}reverse(e){return e.split("").reverse().join("")}encode({fen:e,colored:t}){return t?{board:i(this,c,M).call(this,e),masks:i(this,c,E).call(this,e)}:{board:i(this,c,L).call(this,e),masks:null}}}g=new WeakMap,q=new WeakMap,c=new WeakSet,E=function(e){return i(this,c,N).call(this,e,t=>s(this,q).get(t))},M=function(e){return i(this,c,N).call(this,e,t=>s(this,g).get(t).light)},L=function(e){return i(this,c,N).call(this,e,(t,n)=>{const r=n*9&8?"dark":"light";return s(this,g).get(t)[r]})},N=function(e,t){return e.split(" ")[0].replace(/\//g,"").replace(/\d/g,n=>" ".repeat(+n)).slice(0,64).replace(/./g,(...n)=>t(...n)).match(/.{1,8}/g)};function A(p){const e="http://www.w3.org/2000/svg",t=document.createElementNS(e,"svg");if(t.setAttribute("version","1.1"),t.setAttribute("viewBox","0 0 64 64"),p){const r=document.createElementNS(e,"pattern");r.setAttribute("id","checkered"),r.setAttribute("viewBox","0 0 1 1"),r.setAttribute("patternUnits","userSpaceOnUse"),r.setAttribute("width","16"),r.setAttribute("height","16");const P=document.createElementNS(e,"rect");P.setAttribute("style","fill: var(--diagram-light)"),P.setAttribute("width","1"),P.setAttribute("height","1");const l=document.createElementNS(e,"path");l.setAttribute("style","fill: var(--diagram-dark)"),l.setAttribute("d","M 0.5,0 V 1 H 0 V 0.5 H 1 V 0 Z"),r.appendChild(P),r.appendChild(l),t.appendChild(r);const f=document.createElementNS(e,"rect");f.setAttribute("width","100%"),f.setAttribute("height","100%"),f.setAttribute("style","fill:url(#checkered)"),t.appendChild(f)}const n=[];for(let r=8;r<=64;r+=8){const P=document.createElementNS(e,"text");P.setAttribute("y",r.toString()),n.push(P)}return n.forEach(r=>t.appendChild(r)),{svg:t,ranks:n}}const Z=`
	:host {
		display: block;
		position: relative;
	}
	svg {
		font-family: var(--diagram-font);
		user-select: none;
	}
	text {
		font-size: 8px;
		fill: var(--diagram-stroke, #000);
		dominant-baseline: text-after-edge;
	}
	svg + svg {
		position: absolute;
		inset: 0;
		width: 100%;
		z-index: -1;
	}
	svg + svg text {
		fill: var(--diagram-fill, #fff);
	}
`;function G(){const p=new CSSStyleSheet;return p.replaceSync(Z),p}function C(p,e){return[p.toLowerCase(),""].includes(e==null?void 0:e.toLowerCase())}var R,m,K,u,d,h,k,o,T,$,B,D,w;class O extends HTMLElement{constructor(){super();a(this,o);a(this,R,new I);a(this,m,"8/8/8/8/8/8/8/8");a(this,K,!1);a(this,u,!1);a(this,d);a(this,h);a(this,k,null);b(this,d,this.attachShadow({mode:"closed"}))}connectedCallback(){s(this,h)||(i(this,o,T).call(this),i(this,o,$).call(this)),s(this,u)&&i(this,o,B).call(this),i(this,o,w).call(this)}attributeChangedCallback(t,n,r){switch(t){case"fen":b(this,m,r);break;case"flipped":b(this,K,C("flipped",r));break;case"colored":b(this,u,C("colored",r)),s(this,u)?i(this,o,B).call(this):i(this,o,D).call(this)}s(this,h)&&i(this,o,w).call(this)}}R=new WeakMap,m=new WeakMap,K=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,k=new WeakMap,o=new WeakSet,T=function(){s(this,d).adoptedStyleSheets.push(G())},$=function(){const{svg:t,ranks:n}=A();b(this,h,n),s(this,d).appendChild(t)},B=function(){const{svg:t,ranks:n}=A(!0);b(this,k,n),s(this,d).appendChild(t)},D=function(){b(this,k,null),s(this,d).removeChild(s(this,d).lastChild)},w=function(){const{board:t,masks:n}=s(this,R).encode({fen:s(this,m),colored:s(this,u)});s(this,h).forEach((r,P)=>r.textContent=t[P]),n&&s(this,k).forEach((r,P)=>r.textContent=n[P])},v(O,"observedAttributes",["fen","flipped","colored"]);const W=["Cases","Smart"];function X(p,e){p.forEach(t=>{const n=document.createElement("option");n.textContent=t,e.appendChild(n)})}function Y(p){const e=new CSSStyleSheet,t=`Diagram${p}`,n=`./fonts/${t}`,r=`${t}.woff2`;e.insertRule(`@font-face { font-family: "Diagram ${p}"; src: url("${n}/${r}"); font-display: block; }`),document.adoptedStyleSheets.push(e)}function ee(p){const e=document.querySelector("#app");let t=`--diagram-font: Diagram ${p};`;p==="Assistant"&&(t+=" --diagram-spacing: -0.4cqw"),e.setAttribute("style",t)}function x(p){Y(p),ee(p)}function te(p){const e=fetch("https://lichess.org/api/tv/feed"),t=r=>p(r),n=()=>console.log("The stream has completed");e.then(pe(t)).then(n)}const pe=p=>e=>{const t=e.body.getReader(),n=/\r?\n/,r=new TextDecoder;let P="";const l=()=>t.read().then(({done:f,value:F})=>{if(f)P.length>0&&p(JSON.parse(P));else{const H=r.decode(F,{stream:!0});P+=H;const y=P.split(n);P=y.pop();for(const _ of y.filter(z=>z))p(JSON.parse(_));return l()}});return l()},re=["rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1","rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq - 0 1","rnbqkbnr/pppp1ppp/8/4p3/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 2","rnbqkbnr/pppp1ppp/8/4p3/4PP2/8/PPPP2PP/RNBQKBNR b KQkq - 0 2","rnbqkbnr/pppp1ppp/8/8/4Pp2/8/PPPP2PP/RNBQKBNR w KQkq - 0 3","rnbqkbnr/pppp1ppp/8/8/4Pp2/5N2/PPPP2PP/RNBQKB1R b KQkq - 1 3","rnbqkb1r/pppp1ppp/5n2/8/4Pp2/5N2/PPPP2PP/RNBQKB1R w KQkq - 2 4","rnbqkb1r/pppp1ppp/5n2/4P3/5p2/5N2/PPPP2PP/RNBQKB1R b KQkq - 0 4","rnbqkb1r/pppp1ppp/8/4P3/5pn1/5N2/PPPP2PP/RNBQKB1R w KQkq - 1 5","rnbqkb1r/pppp1ppp/8/4P3/3P1pn1/5N2/PPP3PP/RNBQKB1R b KQkq - 0 5","rnbqkb1r/pppp1p1p/8/4P1p1/3P1pn1/5N2/PPP3PP/RNBQKB1R w KQkq - 0 6","rnbqkb1r/pppp1p1p/8/4P1p1/3P1pn1/2N2N2/PPP3PP/R1BQKB1R b KQkq - 1 6","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N1nN2/PPP3PP/R1BQKB1R w KQkq - 2 7","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N1nN2/PPP1Q1PP/R1B1KB1R b KQkq - 3 7","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N2N2/PPP1Q1PP/R1B1Kn1R w KQkq - 0 8","rnbqkb1r/pppp1p1p/8/4P1p1/3PNp2/5N2/PPP1Q1PP/R1B1Kn1R b KQkq - 1 8","rnbqkb1r/pppp1p1p/8/4P1p1/3PNp2/4nN2/PPP1Q1PP/R1B1K2R w KQkq - 2 9","rnbqkb1r/pppp1p1p/5N2/4P1p1/3P1p2/4nN2/PPP1Q1PP/R1B1K2R b KQkq - 3 9","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/4nN2/PPP1Q1PP/R1B1K2R w KQ - 4 10","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/4nN2/PPPBQ1PP/R3K2R b KQ - 5 10","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PPnBQ1PP/R3K2R w KQ - 0 11","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PPnBQKPP/R6R b - - 1 11","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PP1BQKPP/n6R w - - 0 12","rnbq1b1r/ppppkp1p/8/3NP1p1/3P1p2/5N2/PP1BQKPP/n6R b - - 1 12","rnbq1b1r/pppp1p1p/4k3/3NP1p1/3P1p2/5N2/PP1BQKPP/n6R w - - 2 13","rnbq1b1r/pppp1p1p/4k3/3NP1p1/2QP1p2/5N2/PP1B1KPP/n6R b - - 3 13","rnbq1b1r/p1pp1p1p/4k3/1p1NP1p1/2QP1p2/5N2/PP1B1KPP/n6R w - - 0 14","rnbq1b1r/p1pp1p1p/4k3/1p1NP1N1/2QP1p2/8/PP1B1KPP/n6R b - - 0 14","rnb2b1r/p1pp1p1p/4k3/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R w - - 0 15","rnb2b1r/p1Np1p1p/4k3/1p2P1q1/2QP1p2/8/PP1B1KPP/n6R b - - 0 15","rnb2b1r/p1Npkp1p/8/1p2P1q1/2QP1p2/8/PP1B1KPP/n6R w - - 1 16","rnb2b1r/p2pkp1p/8/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R b - - 2 16","rnb2b1r/p2p1p1p/4k3/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R w - - 3 17","rnb2b1r/p2p1p1p/4k3/1p2P1q1/2QP1N2/8/PP1B1KPP/n6R b - - 0 17","rnb2b1r/p2pkp1p/8/1p2P1q1/2QP1N2/8/PP1B1KPP/n6R w - - 1 18","rnb2b1r/p2pkp1p/8/1p1NP1q1/2QP4/8/PP1B1KPP/n6R b - - 2 18","rnb1kb1r/p2p1p1p/8/1p1NP1q1/2QP4/8/PP1B1KPP/n6R w - - 3 19","rnQ1kb1r/p2p1p1p/8/1p1NP1q1/3P4/8/PP1B1KPP/n6R b - - 0 19","rnQqkb1r/p2p1p1p/8/1p1NP3/3P4/8/PP1B1KPP/n6R w - - 1 20","rnQqkb1r/p1Np1p1p/8/1p2P3/3P4/8/PP1B1KPP/n6R b - - 2 20","rnQq1b1r/p1Npkp1p/8/1p2P3/3P4/8/PP1B1KPP/n6R w - - 3 21","rnQq1b1r/p1Npkp1p/8/1p2P3/1B1P4/8/PP3KPP/n6R b - - 4 21","rnQq1b1r/p1N1kp1p/3p4/1p2P3/1B1P4/8/PP3KPP/n6R w - - 0 22","rnQq1b1r/p1N1kp1p/3B4/1p2P3/3P4/8/PP3KPP/n6R b - - 0 22","rnQ2b1r/p1N1kp1p/3q4/1p2P3/3P4/8/PP3KPP/n6R w - - 0 23","rn2Qb1r/p1N1kp1p/3q4/1p2P3/3P4/8/PP3KPP/n6R b - - 1 23"];function ne(){const{random:p}=Math,e=p(),t=(n,r)=>n+p()*r;return e<.05?t(0,200):e<.1?t(2e3,1e3):e<.35?t(900,600):t(300,600)}const Pe=p=>new Promise(e=>setTimeout(e,p));async function se(p){for(const e of re)p({d:{fen:e}}),await Pe(ne())}customElements.define("demo-diagram",O);{const p=document.querySelector("#typography");X(W,p),x(p.value),p.addEventListener("change",({target:e})=>x(e.value))}{let e=function(t){document.querySelectorAll("demo-diagram").forEach(n=>t?n.setAttribute("colored","colored"):n.removeAttribute("colored"))};var oe=e;const p=document.querySelector("#colored");e(p.checked),p.addEventListener("change",({target:t})=>e(t.checked))}{let p=function({players:e,isFlipped:t,figure:n}){let[r,P]=n.querySelectorAll(".player");t&&([r,P]=[P,r]),P.classList.remove("accent"),r.classList.add("accent"),P.textContent=e[0].user.name,r.textContent=e[1].user.name};var ae=p;te(({t:e,d:t})=>{const n=document.querySelector("figure#live"),r=n.querySelector("demo-diagram");if(r.setAttribute("fen",t.fen),e==="featured"){const P=t.orientation==="black";P?r.setAttribute("flipped","flipped"):r.removeAttribute("flipped"),p({...t,isFlipped:P,figure:n})}})}se(({d:p})=>{document.querySelector("figure#bronstein").querySelector("demo-diagram").setAttribute("fen",p.fen)});
