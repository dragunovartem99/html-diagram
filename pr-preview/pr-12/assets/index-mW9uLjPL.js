var z=Object.defineProperty;var w=t=>{throw TypeError(t)};var J=(t,e,p)=>e in t?z(t,e,{enumerable:!0,configurable:!0,writable:!0,value:p}):t[e]=p;var S=(t,e,p)=>J(t,typeof e!="symbol"?e+"":e,p),K=(t,e,p)=>e.has(t)||w("Cannot "+p);var s=(t,e,p)=>(K(t,e,"read from private field"),p?p.call(t):e.get(t)),a=(t,e,p)=>e.has(t)?w("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,p),d=(t,e,p,n)=>(K(t,e,"write to private field"),n?n.call(t,p):e.set(t,p),p),o=(t,e,p)=>(K(t,e,"access private method"),p);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const P of r)if(P.type==="childList")for(const h of P.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&n(h)}).observe(document,{childList:!0,subtree:!0});function p(r){const P={};return r.integrity&&(P.integrity=r.integrity),r.referrerPolicy&&(P.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?P.credentials="include":r.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function n(r){if(r.ep)return;r.ep=!0;const P=p(r);fetch(r.href,P)}})();function G(){return new Map([["K",{light:"K",dark:"k"}],["Q",{light:"Q",dark:"q"}],["R",{light:"R",dark:"r"}],["B",{light:"B",dark:"b"}],["N",{light:"N",dark:"n"}],["P",{light:"P",dark:"p"}],["k",{light:"Ц",dark:"ц"}],["q",{light:"Ф",dark:"ф"}],["r",{light:"Л",dark:"л"}],["b",{light:"С",dark:"с"}],["n",{light:"К",dark:"к"}],["p",{light:"П",dark:"п"}],[" ",{light:"_",dark:"-"}]])}function I(){return new Map([["K","0"],["Q","1"],["R","2"],["B","3"],["N","4"],["P","5"],["k","6"],["q","7"],["r","8"],["b","9"],["n",":"],["p",";"],[" ","_"]])}var k,m,c,x,L,M,N;class U{constructor(){a(this,c);a(this,k,G());a(this,m,I())}reverse(e){return e.split("").reverse().join("")}encode({fen:e,colored:p}){return p?{board:o(this,c,L).call(this,e),masks:o(this,c,x).call(this,e)}:{board:o(this,c,M).call(this,e),masks:null}}}k=new WeakMap,m=new WeakMap,c=new WeakSet,x=function(e){return o(this,c,N).call(this,e,p=>s(this,m).get(p))},L=function(e){return o(this,c,N).call(this,e,p=>s(this,k).get(p).light)},M=function(e){return o(this,c,N).call(this,e,(p,n)=>{const r=n*9&8?"dark":"light";return s(this,k).get(p)[r]})},N=function(e,p){return e.split(" ")[0].replace(/\//g,"").replace(/\d/g,n=>" ".repeat(+n)).slice(0,64).replace(/./g,(...n)=>p(...n)).match(/.{1,8}/g)};function v(){const t="http://www.w3.org/2000/svg",e=document.createElementNS(t,"svg");e.setAttribute("version","1.1"),e.setAttribute("viewBox","0 0 64 64");const p=[];for(let n=0;n<64;n+=8){const r=document.createElementNS(t,"text");r.setAttribute("y",n.toString()),r.setAttribute("textLength","100%"),r.setAttribute("lengthAdjust","spacingAndGlyphs"),p.push(r)}return p.forEach(n=>e.appendChild(n)),{svg:e,ranks:p}}const W=`
	:host {
		display: block;
		position: relative;
	}
	svg {
		display: block;
		font-family: var(--diagram-font);
	}
	text {
		font-size: 8px;
		fill: var(--diagram-stroke, #000);
		dominant-baseline: text-before-edge;
	}
	svg + svg {
		position: absolute;
		z-index: -1;
		top: 0;
		bottom: 0;
		left: 0;
		right: 0;
		background:
			repeating-conic-gradient(
				var(--diagram-light, white) 0% 25%,
				var(--diagram-dark, gray) 0% 50%
			)
			100% 0% / 25% 25%;
	}
	svg + svg text {
		fill: var(--diagram-fill, #fff);
	}
`;function X(){const t=new CSSStyleSheet;return t.replaceSync(W),t}function C(t,e){return[t.toLowerCase(),""].includes(e==null?void 0:e.toLowerCase())}var q,g,R,b,l,u,f,i,O,T,Q,$,B;class E extends HTMLElement{constructor(){super();a(this,i);a(this,q,new U);a(this,g,"8/8/8/8/8/8/8/8");a(this,R,!1);a(this,b,!1);a(this,l);a(this,u);a(this,f,null);d(this,l,this.attachShadow({mode:"closed"}))}connectedCallback(){s(this,u)||(o(this,i,O).call(this),o(this,i,T).call(this)),s(this,b)&&o(this,i,Q).call(this),o(this,i,B).call(this)}attributeChangedCallback(p,n,r){switch(p){case"fen":d(this,g,r);break;case"flipped":d(this,R,C("flipped",r));break;case"colored":d(this,b,C("colored",r)),s(this,b)?o(this,i,Q).call(this):o(this,i,$).call(this)}s(this,u)&&o(this,i,B).call(this)}}q=new WeakMap,g=new WeakMap,R=new WeakMap,b=new WeakMap,l=new WeakMap,u=new WeakMap,f=new WeakMap,i=new WeakSet,O=function(){s(this,l).adoptedStyleSheets.push(X())},T=function(){const{svg:p,ranks:n}=v();d(this,u,n),s(this,l).appendChild(p)},Q=function(){const{svg:p,ranks:n}=v();d(this,f,n),s(this,l).appendChild(p)},$=function(){d(this,f,null),s(this,l).removeChild(s(this,l).lastChild)},B=function(){const{board:p,masks:n}=s(this,q).encode({fen:s(this,g),colored:s(this,b)});s(this,u).forEach((r,P)=>r.textContent=p[P]),n&&s(this,f).forEach((r,P)=>r.textContent=n[P])},S(E,"observedAttributes",["fen","flipped","colored"]);const Y=["Cases","Smart"];function Z(t,e){t.forEach(p=>{const n=document.createElement("option");n.textContent=p,e.appendChild(n)})}function V(t){const e=new CSSStyleSheet,p=`Diagram${t}`,n=`./fonts/${p}`,r=`${p}.woff2`;e.insertRule(`@font-face { font-family: "Diagram ${t}"; src: url("${n}/${r}"); font-display: block; }`),document.adoptedStyleSheets.push(e)}function ee(t){const e=document.querySelector("#app");let p=`--diagram-font: Diagram ${t};`;t==="Assistant"&&(p+=" --diagram-spacing: -0.4cqw"),e.setAttribute("style",p)}function A(t){V(t),ee(t)}function te(t){const e=fetch("https://lichess.org/api/tv/feed"),p=r=>t(r),n=()=>console.log("The stream has completed");e.then(pe(p)).then(n)}const pe=t=>e=>{const p=e.body.getReader(),n=/\r?\n/,r=new TextDecoder;let P="";const h=()=>p.read().then(({done:D,value:F})=>{if(D)P.length>0&&t(JSON.parse(P));else{const H=r.decode(F,{stream:!0});P+=H;const y=P.split(n);P=y.pop();for(const _ of y.filter(j=>j))t(JSON.parse(_));return h()}});return h()},re=["rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1","rnbqkbnr/pppppppp/8/8/4P3/8/PPPP1PPP/RNBQKBNR b KQkq - 0 1","rnbqkbnr/pppp1ppp/8/4p3/4P3/8/PPPP1PPP/RNBQKBNR w KQkq - 0 2","rnbqkbnr/pppp1ppp/8/4p3/4PP2/8/PPPP2PP/RNBQKBNR b KQkq - 0 2","rnbqkbnr/pppp1ppp/8/8/4Pp2/8/PPPP2PP/RNBQKBNR w KQkq - 0 3","rnbqkbnr/pppp1ppp/8/8/4Pp2/5N2/PPPP2PP/RNBQKB1R b KQkq - 1 3","rnbqkb1r/pppp1ppp/5n2/8/4Pp2/5N2/PPPP2PP/RNBQKB1R w KQkq - 2 4","rnbqkb1r/pppp1ppp/5n2/4P3/5p2/5N2/PPPP2PP/RNBQKB1R b KQkq - 0 4","rnbqkb1r/pppp1ppp/8/4P3/5pn1/5N2/PPPP2PP/RNBQKB1R w KQkq - 1 5","rnbqkb1r/pppp1ppp/8/4P3/3P1pn1/5N2/PPP3PP/RNBQKB1R b KQkq - 0 5","rnbqkb1r/pppp1p1p/8/4P1p1/3P1pn1/5N2/PPP3PP/RNBQKB1R w KQkq - 0 6","rnbqkb1r/pppp1p1p/8/4P1p1/3P1pn1/2N2N2/PPP3PP/R1BQKB1R b KQkq - 1 6","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N1nN2/PPP3PP/R1BQKB1R w KQkq - 2 7","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N1nN2/PPP1Q1PP/R1B1KB1R b KQkq - 3 7","rnbqkb1r/pppp1p1p/8/4P1p1/3P1p2/2N2N2/PPP1Q1PP/R1B1Kn1R w KQkq - 0 8","rnbqkb1r/pppp1p1p/8/4P1p1/3PNp2/5N2/PPP1Q1PP/R1B1Kn1R b KQkq - 1 8","rnbqkb1r/pppp1p1p/8/4P1p1/3PNp2/4nN2/PPP1Q1PP/R1B1K2R w KQkq - 2 9","rnbqkb1r/pppp1p1p/5N2/4P1p1/3P1p2/4nN2/PPP1Q1PP/R1B1K2R b KQkq - 3 9","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/4nN2/PPP1Q1PP/R1B1K2R w KQ - 4 10","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/4nN2/PPPBQ1PP/R3K2R b KQ - 5 10","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PPnBQ1PP/R3K2R w KQ - 0 11","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PPnBQKPP/R6R b - - 1 11","rnbq1b1r/ppppkp1p/5N2/4P1p1/3P1p2/5N2/PP1BQKPP/n6R w - - 0 12","rnbq1b1r/ppppkp1p/8/3NP1p1/3P1p2/5N2/PP1BQKPP/n6R b - - 1 12","rnbq1b1r/pppp1p1p/4k3/3NP1p1/3P1p2/5N2/PP1BQKPP/n6R w - - 2 13","rnbq1b1r/pppp1p1p/4k3/3NP1p1/2QP1p2/5N2/PP1B1KPP/n6R b - - 3 13","rnbq1b1r/p1pp1p1p/4k3/1p1NP1p1/2QP1p2/5N2/PP1B1KPP/n6R w - - 0 14","rnbq1b1r/p1pp1p1p/4k3/1p1NP1N1/2QP1p2/8/PP1B1KPP/n6R b - - 0 14","rnb2b1r/p1pp1p1p/4k3/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R w - - 0 15","rnb2b1r/p1Np1p1p/4k3/1p2P1q1/2QP1p2/8/PP1B1KPP/n6R b - - 0 15","rnb2b1r/p1Npkp1p/8/1p2P1q1/2QP1p2/8/PP1B1KPP/n6R w - - 1 16","rnb2b1r/p2pkp1p/8/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R b - - 2 16","rnb2b1r/p2p1p1p/4k3/1p1NP1q1/2QP1p2/8/PP1B1KPP/n6R w - - 3 17","rnb2b1r/p2p1p1p/4k3/1p2P1q1/2QP1N2/8/PP1B1KPP/n6R b - - 0 17","rnb2b1r/p2pkp1p/8/1p2P1q1/2QP1N2/8/PP1B1KPP/n6R w - - 1 18","rnb2b1r/p2pkp1p/8/1p1NP1q1/2QP4/8/PP1B1KPP/n6R b - - 2 18","rnb1kb1r/p2p1p1p/8/1p1NP1q1/2QP4/8/PP1B1KPP/n6R w - - 3 19","rnQ1kb1r/p2p1p1p/8/1p1NP1q1/3P4/8/PP1B1KPP/n6R b - - 0 19","rnQqkb1r/p2p1p1p/8/1p1NP3/3P4/8/PP1B1KPP/n6R w - - 1 20","rnQqkb1r/p1Np1p1p/8/1p2P3/3P4/8/PP1B1KPP/n6R b - - 2 20","rnQq1b1r/p1Npkp1p/8/1p2P3/3P4/8/PP1B1KPP/n6R w - - 3 21","rnQq1b1r/p1Npkp1p/8/1p2P3/1B1P4/8/PP3KPP/n6R b - - 4 21","rnQq1b1r/p1N1kp1p/3p4/1p2P3/1B1P4/8/PP3KPP/n6R w - - 0 22","rnQq1b1r/p1N1kp1p/3B4/1p2P3/3P4/8/PP3KPP/n6R b - - 0 22","rnQ2b1r/p1N1kp1p/3q4/1p2P3/3P4/8/PP3KPP/n6R w - - 0 23","rn2Qb1r/p1N1kp1p/3q4/1p2P3/3P4/8/PP3KPP/n6R b - - 1 23"];function ne(){const{random:t}=Math,e=t(),p=(n,r)=>n+t()*r;return e<.05?p(0,200):e<.1?p(2e3,1e3):e<.35?p(900,600):p(300,600)}const Pe=t=>new Promise(e=>setTimeout(e,t));async function se(t){for(const e of re)t({d:{fen:e}}),await Pe(ne())}customElements.define("demo-diagram",E);{const t=document.querySelector("#typography");Z(Y,t),A(t.value),t.addEventListener("change",({target:e})=>A(e.value))}{let e=function(p){document.querySelectorAll("demo-diagram").forEach(n=>p?n.setAttribute("colored","colored"):n.removeAttribute("colored"))};var ie=e;const t=document.querySelector("#colored");e(t.checked),t.addEventListener("change",({target:p})=>e(p.checked))}{let t=function({players:e,isFlipped:p,figure:n}){let[r,P]=n.querySelectorAll(".player");p&&([r,P]=[P,r]),P.classList.remove("accent"),r.classList.add("accent"),P.textContent=e[0].user.name,r.textContent=e[1].user.name};var ae=t;te(({t:e,d:p})=>{const n=document.querySelector("figure#live"),r=n.querySelector("demo-diagram");if(r.setAttribute("fen",p.fen),e==="featured"){const P=p.orientation==="black";P?r.setAttribute("flipped","flipped"):r.removeAttribute("flipped"),t({...p,isFlipped:P,figure:n})}})}se(({d:t})=>{document.querySelector("figure#bronstein").querySelector("demo-diagram").setAttribute("fen",t.fen)});
